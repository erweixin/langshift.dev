---
title: "模块 15：Go 生态系统和库"
---

本模块探索 Go 生态系统，比较流行的 Go 库与 Java 的对应库。

## Web 框架

**Java Web 框架：**
- Spring Boot：全面、功能丰富
- Jakarta EE：面向企业
- Micronaut：现代、编译时聚焦
- Quarkus：云原生、快速启动

**Go Web 框架：**
- Gin：快速、极简主义
- Echo：高性能、极简主义
- Fiber：Express 风格、快速
- Chi：轻量级、可组合

<UniversalEditor title="Web 框架比较">
```java !! java
// Java: Spring Boot REST 控制器
import org.springframework.web.bind.annotation.*;
import org.springframework.stereotype.Service;
import org.springframework.beans.factory.annotation.Autowired;

@RestController
@RequestMapping("/api/users")
public class UserController {

    @Autowired
    private UserService userService;

    @GetMapping
    public List<User> getAllUsers() {
        return userService.findAll();
    }

    @GetMapping("/{id}")
    public ResponseEntity<User> getUser(@PathVariable Long id) {
        return userService.findById(id)
            .map(user -> ResponseEntity.ok().body(user))
            .orElse(ResponseEntity.notFound().build());
    }

    @PostMapping
    @ResponseStatus(HttpStatus.CREATED)
    public User createUser(@Valid @RequestBody User user) {
        return userService.save(user);
    }

    @PutMapping("/{id}")
    public User updateUser(@PathVariable Long id, @RequestBody User user) {
        user.setId(id);
        return userService.save(user);
    }

    @DeleteMapping("/{id}")
    @ResponseStatus(HttpStatus.NO_CONTENT)
    public void deleteUser(@PathVariable Long id) {
        userService.deleteById(id);
    }
}
```

```go !! go
// Go: Gin REST 处理器
package main

import (
    "net/http"
    "github.com/gin-gonic/gin"
)

type User struct {
    ID    uint   `json:"id"`
    Name  string `json:"name" binding:"required"`
    Email string `json:"email" binding:"required,email"`
}

func SetupRoutes(r *gin.Engine) {
    users := r.Group("/api/users")
    {
        users.GET("", getAllUsers)
        users.GET("/:id", getUser)
        users.POST("", createUser)
        users.PUT("/:id", updateUser)
        users.DELETE("/:id", deleteUser)
    }
}

func getAllUsers(c *gin.Context) {
    users, err := userService.FindAll()
    if err != nil {
        c.JSON(http.StatusInternalServerError, gin.H{"error": err.Error()})
        return
    }
    c.JSON(http.StatusOK, users)
}

func createUser(c *gin.Context) {
    var user User
    if err := c.ShouldBindJSON(&user); err != nil {
        c.JSON(http.StatusBadRequest, gin.H{"error": err.Error()})
        return
    }

    if err := userService.Save(&user); err != nil {
        c.JSON(http.StatusInternalServerError, gin.H{"error": err.Error()})
        return
    }

    c.JSON(http.StatusCreated, user)
}
```
</UniversalEditor>

## ORM 和数据库库

<UniversalEditor title="数据库库">
```java !! java
// Java: Spring Data JPA
import org.springframework.data.jpa.repository.*;
import org.springframework.data.domain.*;
import javax.persistence.*;

@Entity
@Table(name = "users")
public class User {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(nullable = false, unique = true)
    private String email;

    private String name;

    @CreationTimestamp
    private LocalDateTime createdAt;

    // Getters and setters
}

interface UserRepository extends JpaRepository<User, Long> {
    Optional<User> findByEmail(String email);

    List<User> findByNameContainingIgnoreCase(String name);
}
```

```go !! go
// Go: GORM
package main

import (
    "time"
    "gorm.io/gorm"
)

type User struct {
    ID        uint           `gorm:"primarykey" json:"id"`
    Email     string         `gorm:"uniqueIndex;not null" json:"email"`
    Name      string         `json:"name"`
    CreatedAt time.Time      `json:"created_at"`
    UpdatedAt time.Time      `json:"updated_at"`
    DeletedAt gorm.DeletedAt `gorm:"index" json:"-"`
}

type UserRepository struct {
    db *gorm.DB
}

func NewUserRepository(db *gorm.DB) *UserRepository {
    return &UserRepository{db: db}
}

func (r *UserRepository) FindByEmail(email string) (*User, error) {
    var user User
    err := r.db.Where("email = ?", email).First(&user).Error
    if err != nil {
        return nil, err
    }
    return &user, nil
}

func (r *UserRepository) Create(user *User) error {
    return r.db.Create(user).Error
}

func (r *UserRepository) Update(user *User) error {
    return r.db.Save(user).Error
}

func (r *UserRepository) Delete(id uint) error {
    return r.db.Delete(&User{}, id).Error
}
```
</UniversalEditor>

## 常用 Go 库分类

| 类别 | Java 库 | Go 库 |
|------|---------|-------|
| Web 框架 | Spring Boot | Gin, Echo, Fiber |
| ORM | Hibernate/JPA | GORM, sqlx |
| 验证 | Hibernate Validator | go-playground/validator |
| 配置 | Spring Cloud Config | Viper |
| 日志 | SLF4J + Logback | Zap, Zerolog |
| 测试 | JUnit + Mockito | testing + testify |
| HTTP 客户端 | RestTemplate/WebClient | resty, fasthttp |
| 依赖注入 | Spring DI / Google Guice | Wire, Fx |
| 速率限制 | Resilience4j | uber-go/ratelimit |
| 缓存 | Caffeine / Redis | go-redis, bigcache |
| 认证 | Spring Security | casbin, jwt-go |
| CLI | Picocli | cobra, viper |
| 数据库迁移 | Flyway / Liquibase | golang-migrate, goose |

---

### 练习问题：
1. 为什么 Go 偏好小型、专注的库而不是综合框架？
2. Go 的依赖注入方法与 Spring 有什么不同？
3. Go 标准库相比 Java 有什么优势？
4. 什么时候你会选择 GORM 而不是 sqlx？

### 项目想法：
- 使用 Gin 和 GORM 构建 REST API
- 使用 Cobra 创建 CLI 工具
- 实现具有适当日志和监控的微服务
- 使用 Wire 设置依赖注入项目

### 下一步：
- 学习 Go 中的数据库集成
- 了解微服务架构
- 探索真实世界项目模式
- 构建生产就绪的应用程序
