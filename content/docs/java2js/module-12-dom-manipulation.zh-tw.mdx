---
title: "Module 12: DOM Manipulation"
description: "掌握 DOM 遍歷、操作和最佳實踐"
---

## Module 12: DOM Manipulation

文件物件模型（DOM）是 JavaScript 與 HTML 文件的介面。本模組將教你如何動態地與網頁互動。

## Learning Objectives

完成本模組後，你將：
✅ 理解 DOM 結構和遍歷
✅ 掌握元素選擇方法
✅ 學習修改 DOM 元素
✅ 理解創建和移除元素
✅ 知道效能最佳實踐
✅ 掌握 DOM 操作模式

## DOM vs Java GUI

<UniversalEditor title="DOM vs Java Swing/JavaFX">
```java !! java
// Java - Swing
JFrame frame = new JFrame("My App");
JButton button = new JButton("Click me");
frame.add(button);
frame.setVisible(true);

// JavaFX
Button btn = new Button("Click me");
Scene scene = new Scene(new StackPane(btn), 300, 250);
stage.setScene(scene);
stage.show();
```

```javascript !! js
// JavaScript - DOM
const button = document.createElement("button");
button.textContent = "Click me";
document.body.appendChild(button);
```
</UniversalEditor>

## Selecting Elements

<UniversalEditor title="元素選擇">
```javascript !! js
// 現代方法（首選）
const byId = document.getElementById("myId");
const byClass = document.getElementsByClassName("myClass");
const byTag = document.getElementsByTagName("div");

// Query selectors（最靈活）
const element = document.querySelector("#myId");
const allElements = document.querySelectorAll(".myClass");

// CSS selectors
const element1 = document.querySelector("#container .item");
const element2 = document.querySelector("button[data-action='submit']");

// Context selection
const container = document.querySelector("#container");
const items = container.querySelectorAll(".item");  // 僅在 container 內

// 最佳實踐：緩存選擇器
const button = document.getElementById("submit");
button.addEventListener("click", handleClick);
```
</UniversalEditor>

## Traversing the DOM

<UniversalEditor title="DOM 遍歷">
```javascript !! js
const parent = document.getElementById("parent");

// Children
const children = parent.children;  // HTMLCollection (live)
const childNodes = parent.childNodes;  // NodeList (live)
const firstChild = parent.firstElementChild;
const lastChild = parent.lastElementChild;

// Siblings
const nextSibling = element.nextElementSibling;
const prevSibling = element.previousElementSibling;

// Parent
const parent = element.parentElement;

// Finding elements
const closestParent = element.closest(".container");
const matches = element.matches(".active");
```
</UniversalEditor>

## Modifying Elements

<UniversalEditor title="修改元素">
```javascript !! js
const element = document.querySelector("#myElement");

// Content
element.textContent = "New text";  // 純文本
element.innerHTML = "<strong>New HTML</strong>";  // HTML（安全風險！）

// Attributes
element.setAttribute("class", "active");
element.getAttribute("class");
element.hasAttribute("class");
element.removeAttribute("class");

// Properties（首選）
element.id = "myId";
element.className = "my-class";
element.href = "https://example.com";
element.disabled = true;

// Classes
element.classList.add("active");
element.classList.remove("inactive");
element.classList.toggle("active");
element.classList.contains("active");

// Styles
element.style.color = "red";
element.style.backgroundColor = "blue";
```
</UniversalEditor>

## Creating and Removing Elements

<UniversalEditor title="創建和移除">
```javascript !! js
// Create element
const div = document.createElement("div");
div.textContent = "Hello";
div.className = "greeting";

// Add to DOM
document.body.appendChild(div);
container.insertBefore(div, container.firstChild);

// Remove element
child.remove();  // Modern

// Clone element
const clone = element.cloneNode(true);  // Deep clone
```
</UniversalEditor>

## Best Practices

<UniversalEditor title="DOM 最佳實踐">
```javascript !! js
// 1. 最小化 reflows 和 repaints
// Bad: 多次 reflow
element.style.width = "100px";
element.style.height = "100px";

// Good: 單次 reflow
element.style.cssText = "width: 100px; height: 100px;";

// Better: 使用類別
element.className = "optimized-style";

// 2. 批量 DOM 更新
// Good: Document fragment
const fragment = document.createDocumentFragment();
items.forEach(item => {
    fragment.appendChild(createElement(item));
});
document.body.appendChild(fragment);  // 單次 reflow

// 3. 緩存 DOM 查詢
const result = document.getElementById("result");
function update() {
    result.textContent = "Done";
}

// 4. 使用事件委派
container.addEventListener("click", (e) => {
    if (e.target.matches(".item")) {
        handleClick(e);
    }
});
```
</UniversalEditor>

## Summary

### Key Takeaways

1. **Selection:** 使用 querySelector/querySelectorAll
2. **Traversal:** parentElement、children、nextElementSibling
3. **Modification:** textContent、classList、style
4. **Performance:** 最小化 reflows、批量更新、緩存查詢

## What's Next?

接下來是 **Module 13: Event Handling** - 掌握事件、傳播和委派！
