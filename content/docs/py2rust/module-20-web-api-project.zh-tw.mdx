---
title: "æ¨¡çµ„ 20: REST API å°ˆæ¡ˆ"
description: "ä½¿ç”¨ Axum å»ºæ§‹å®Œæ•´çš„ REST API,åŒ…æ‹¬è³‡æ–™åº«æ•´åˆã€JWT èªè­‰ã€æ¸¬è©¦å’Œéƒ¨ç½²"
---

# æ¨¡çµ„ 20: REST API å°ˆæ¡ˆ

## å­¸ç¿’ç›®æ¨™

å®Œæˆæœ¬æ¨¡çµ„å¾Œ,ä½ å°‡å»ºæ§‹:
- ä½¿ç”¨ Axum çš„å®Œæ•´ REST API
- ä½¿ç”¨ SQLx çš„è³‡æ–™åº«æ•´åˆ
- JWT èªè­‰ç³»çµ±
- å…¨é¢çš„æ¸¬è©¦å¥—ä»¶
- ç”Ÿç”¢å°±ç·’çš„éƒ¨ç½²è¨­å®š

## å°ˆæ¡ˆæ¦‚è¿°

æˆ‘å€‘å°‡å»ºæ§‹ä¸€å€‹ä»»å‹™ç®¡ç† API,åŒ…å«:
- ä½¿ç”¨è€…è¨»å†Šå’Œèªè­‰
- ä»»å‹™çš„ CRUD æ“ä½œ
- åŸºæ–¼ JWT çš„èªè­‰
- PostgreSQL è³‡æ–™åº«
- å…¨é¢çš„æ¸¬è©¦

<UniversalEditor compare={true} title="å°ˆæ¡ˆçµæ§‹">
```python !! py
# Python - FastAPI å°ˆæ¡ˆçµæ§‹
task_api/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py          # FastAPI æ‡‰ç”¨
â”‚   â”œâ”€â”€ models.py        # SQLAlchemy æ¨¡å‹
â”‚   â”œâ”€â”€ auth.py          # èªè­‰
â”‚   â””â”€â”€ database.py      # è³‡æ–™åº«è¨­å®š
â”œâ”€â”€ tests/
â””â”€â”€ requirements.txt
```

```rust !! rs
// Rust - Axum å°ˆæ¡ˆçµæ§‹
task_api/
â”œâ”€â”€ Cargo.toml
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.rs          # Axum æ‡‰ç”¨è¨­å®š
â”‚   â”œâ”€â”€ models.rs        # è³‡æ–™åº«æ¨¡å‹
â”‚   â”œâ”€â”€ handlers.rs      # è«‹æ±‚è™•ç†
â”‚   â”œâ”€â”€ auth.rs          # JWT èªè­‰
â”‚   â””â”€â”€ db.rs            # è³‡æ–™åº«é€£ç·š
â””â”€â”€ tests/
```
</UniversalEditor>

## Cargo.toml è¨­å®š

<UniversalEditor compare={true} title="ä¾è³´é …">
```python !! py
# Python - requirements.txt
fastapi==0.109.0
uvicorn[standard]==0.27.0
sqlalchemy==2.0.25
pydantic==2.5.3
python-jose[cryptography]==3.3.0
passlib[bcrypt]==1.7.4
```

```rust !! rs
// Rust - Cargo.toml
[dependencies]
axum = "0.7"
tokio = { version = "1", features = ["full"] }
sqlx = { version = "0.7", features = ["runtime-tokio-rustls", "postgres", "uuid", "chrono"] }
serde = { version = "1", features = ["derive"] }
serde_json = "1"
uuid = { version = "1", features = ["serde", "v4"] }
chrono = { version = "0.4", features = ["serde"] }
jsonwebtoken = "9"
bcrypt = "0.15"
tower-http = { version = "0.5", features = ["cors", "trace"] }
anyhow = "1"
```
</UniversalEditor>

## è³‡æ–™åº«æ¨¡å‹

<UniversalEditor compare={true} title="è³‡æ–™æ¨¡å‹">
```python !! py
# Python - SQLAlchemy æ¨¡å‹
from sqlalchemy import Column, String, Boolean, DateTime
from sqlalchemy.dialects.postgresql import UUID
import uuid

class User(Base):
    __tablename__ = "users"

    id = Column(UUID(as_uuid=True), primary_key=True, default=uuid.uuid4)
    email = Column(String, unique=True, nullable=False, index=True)
    password_hash = Column(String, nullable=False)
    created_at = Column(DateTime, default=datetime.utcnow)
```

```rust !! rs
// Rust - SQLx æ¨¡å‹
use chrono::{DateTime, Utc};
use serde::{Deserialize, Serialize};
use sqlx::FromRow;
use uuid::Uuid;

#[derive(Debug, Serialize, Deserialize, FromRow)]
pub struct User {
    pub id: Uuid,
    pub email: String,
    pub password_hash: String,
    pub created_at: DateTime<Utc>,
}

#[derive(Debug, Deserialize)]
pub struct CreateUser {
    pub email: String,
    pub password: String,
}
```
</UniversalEditor>

## ä¸»æ‡‰ç”¨ç¨‹å¼

<UniversalEditor compare={true} title="æ‡‰ç”¨è¨­å®š">
```python !! py
# Python - FastAPI æ‡‰ç”¨
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware

app = FastAPI(title="Task API")

app.add_middleware(
    CORSMiddleware,
    allow_origins=["http://localhost:3000"],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

```rust !! rs
// Rust - Axum æ‡‰ç”¨
use axum::{
    routing::{get, post},
    Router,
};
use tower_http::cors::{CorsLayer, Any};

#[tokio::main]
async fn main() -> anyhow::Result<()> {
    let app = Router::new()
        .route("/", get(root))
        .route("/register", post(register))
        .route("/tasks", get(list_tasks).post(create_task))
        .layer(CorsLayer::new().allow_origin(Any))
        .with_state(app_state);

    let listener = TcpListener::bind("0.0.0.0:8000").await?;
    axum::serve(listener, app).await?;

    Ok(())
}
```
</UniversalEditor>

## éƒ¨ç½²

<UniversalEditor compare={true} title="éƒ¨ç½²é…ç½®">
```dockerfile !! dockerfile
# Rust - Dockerfile
FROM rust:1.75 as builder

WORKDIR /app
COPY Cargo.toml Cargo.lock ./
COPY src ./src

RUN cargo build --release

FROM debian:bookworm-slim

WORKDIR /app
COPY --from=builder /app/target/release/task_api /app/task_api

EXPOSE 8000

CMD ["./task_api"]
```

```yaml !! yaml
# docker-compose.yml
version: '3.8'

services:
  api:
    build: .
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=postgresql://user:pass@db:5432/taskdb
    depends_on:
      - db

  db:
    image: postgres:16
    environment:
      - POSTGRES_DB=taskdb
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:
```
</UniversalEditor>

## å°ˆæ¡ˆç¸½çµ

### æˆ‘å€‘å»ºæ§‹äº†ä»€éº¼

1. **ä½¿ç”¨ Axum çš„ REST API**
   - ä½¿ç”¨è€…è¨»å†Šå’Œèªè­‰
   - ä»»å‹™çš„ CRUD æ“ä½œ
   - åŸºæ–¼ JWT çš„å®‰å…¨

2. **è³‡æ–™åº«æ•´åˆ**
   - ä½¿ç”¨ SQLx çš„ PostgreSQL
   - å‹åˆ¥å®‰å…¨çš„æŸ¥è©¢
   - é·ç§»æ”¯æ´

3. **ç”Ÿç”¢å°±ç·’**
   - Docker éƒ¨ç½²
   - ç’°å¢ƒè¨­å®š
   - éŒ¯èª¤è™•ç†

### é—œéµè¦é»

**Python/FastAPI:**
- å¿«é€Ÿé–‹ç™¼
- æ˜“æ–¼é–±è®€å’Œä¿®æ”¹
- å‹•æ…‹å‹åˆ¥éˆæ´»æ€§
- é©åˆåŸå‹é–‹ç™¼

**Rust/Axum:**
- å‹åˆ¥å®‰å…¨çš„è³‡æ–™åº«æŸ¥è©¢
- é›¶æˆæœ¬æŠ½è±¡
- è¨˜æ†¶é«”å®‰å…¨ä¿è­‰
- å“è¶Šçš„æ•ˆèƒ½
- ç·¨è­¯æ™‚éŒ¯èª¤æª¢æŸ¥

## æœ€çµ‚ç·´ç¿’

1. æ–°å¢ä»»å‹™éæ¿¾å’Œåˆ†é 
2. å¯¦ä½œä»»å‹™åˆ†é¡/æ¨™ç±¤
3. æ–°å¢éƒµä»¶é€šçŸ¥
4. å»ºç«‹å‰ç«¯å®¢æˆ¶ç«¯
5. éƒ¨ç½²åˆ°ç”Ÿç”¢ç’°å¢ƒ

## çµèª

æ­å–œ!ä½ å·²å®Œæˆ Python åˆ° Rust çš„å­¸ç¿’è·¯å¾‘ã€‚ä½ ç¾åœ¨æ“æœ‰:

- Rust èªæ³•å’Œæ¦‚å¿µçš„å …å¯¦åŸºç¤
- å¯¦éš› Rust é–‹ç™¼ç¶“é©—
- ç†è§£ Rust çš„æ•ˆèƒ½å„ªå‹¢
- æ¸¬è©¦å’Œéƒ¨ç½²å¯¦è¸çŸ¥è­˜

ç¹¼çºŒä½ çš„ Rust ä¹‹æ—…:
- ç‚ºé–‹æº Rust å°ˆæ¡ˆè²¢ç»
- å»ºæ§‹æ›´è¤‡é›œçš„æ‡‰ç”¨
- æ·±å…¥æ¢ç´¢éåŒæ­¥ Rust
- å­¸ç¿’ä½¿ç”¨ Rust çš„ WebAssembly

æ„‰å¿«åœ°ä½¿ç”¨ Rust ç·¨ç¢¼! ğŸ¦€
