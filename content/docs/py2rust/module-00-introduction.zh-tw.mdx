---
title: "模組 0：介紹與環境建置"
description: "透過了解 Rust 的重要性、安裝工具鏈和編寫第一個 Rust 程式來開始你的 Rust 之旅。"
---

# 模組 0：介紹與環境建置

歡迎來到你的 Rust 之旅！在本模組中，你將學習為什麼 Rust 值得你投入時間，安裝 Rust 工具鏈，並編寫你的第一個 Rust 程式。

## 學習目標

完成本模組後，你將能夠：
- ✅ 理解 Rust 的獨特和價值所在
- ✅ 安裝 Rust 並設定開發環境
- ✅ 使用 Cargo（Rust 的套件管理器和建構工具）
- ✅ 編寫並執行第一個 Rust 程式
- ✅ 導航 Rust 生態系統和資源

## 為什麼選擇 Rust？Python 開發者的視角

作為 Python 開發者，你可能會想：「為什麼要學習另一種語言？」讓我們探索 Rust 帶來的價值。

<UniversalEditor compare={true} title="開發體驗：Python vs Rust">
```python !! py
# Python: 編寫快，執行慢
def process_data(items):
    result = []
    for item in items:
        result.append(item * 2)
    return result

# 執行速度比最佳化後的 Rust 慢約 100 倍
# 但只需 5 秒鐘編寫
```

```rust !! rs
// Rust: 更冗長，但速度極快
fn process_data(items: &[i32]) -> Vec<i32> {
    items.iter().map(|x| x * 2).collect()
}

// 執行速度達到 C/C++ 級別
// 初始編寫時間稍長
// 但編譯器在執行前就能捕獲錯誤
```
</UniversalEditor>

### Rust 的價值主張

#### 1. 不犧牲安全性的效能

Python 使用全域解釋器鎖（GIL）和垃圾回收，這限制了效能並使真正的平行性變得具有挑戰性。Rust 為你提供：
- **C/C++ 效能** 而沒有記憶體安全風險
- **真正的平行性** 透過無畏並行
- **可預測的效能** 沒有垃圾回收暫停

<UniversalEditor compare={true} title="效能對比：斐波那契數列">
```python !! py
# Python: fib(35) 約 2.5 秒
import time

def fib(n):
    if n <= 1:
        return n
    return fib(n-1) + fib(n-2)

start = time.time()
print(fib(35))
print(f"耗時: {time.time() - start:.2f}秒")
```

```rust !! rs
// Rust: fib(35) 約 0.7 秒（快 3.5 倍）
use std::time::Instant;

fn fib(n: u64) -> u64 {
    match n {
        0 => 0,
        1 => 1,
        _ => fib(n-1) + fib(n-2),
    }
}

fn main() {
    let start = Instant::now();
    println!("{}", fib(35));
    println!("耗時: {:?}", start.elapsed());
}
```
</UniversalEditor>

#### 2. 編譯時的記憶體安全

這是 Rust 的超能力。Rust 編譯器可以防止整類錯誤：
- **空指標解引用** → Rust 沒有 null
- **懸垂指標** → 借用檢查器防止無效引用
- **資料競爭** → 型別系統防止並行資料存取問題
- **緩衝區溢位** → 預設邊界檢查

在 Python 中，這些將是執行時錯誤。在 Rust 中，它們是 **編譯時錯誤** - 你在程式碼執行之前就能發現它們。

#### 3. 現代工具鏈

Cargo 是現有的最好的套件管理器之一：

<UniversalEditor compare={true} title="套件管理：pip vs Cargo">
```python !! py
# Python: 多個工具，設定分散
# 建立專案
mkdir myproject
cd myproject
python -m venv venv
source venv/bin/activate

# 新增依賴（手動編輯）
echo "numpy==1.24.0" >> requirements.txt
pip install -r requirements.txt

# 執行測試（需要獨立的測試框架）
pytest

# 建構（用於發佈）
python setup.py sdist bdist_wheel
```

```rust !! rs
// Rust: 統一的工具
// 建立專案
cargo new myproject
cd myproject

// 新增依賴
cargo add serde

// 執行測試（內建）
cargo test

// 建構最佳化後的二進位檔案
cargo build --release
```
</UniversalEditor>

#### 4. 成長的生態系統

Rust 擁有快速成長的生態系統，提供出色的 crate：
- **Web**: Actix-web, Axum, Rocket
- **非同步**: Tokio, async-std
- **序列化**: Serde (JSON, YAML 等)
- **資料庫**: Diesel, SQLx
- **CLI**: Clap, structopt

許多 Python 函式庫現在都有 Rust 加速（例如，用於 Python 綁定的 PyO3）。

## 安裝 Rust

### 步驟 1：安裝 rustup（Rust 工具鏈安裝程式）

**macOS / Linux:**
```bash
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
```

**Windows:**
從 [rustup.rs](https://rustup.rs/) 下載並執行 `rustup-init.exe`

安裝程式將：
1. 安裝 Rust 編譯器（`rustc`）
2. 安裝 Cargo（套件管理器和建構工具）
3. 將 Rust 新增到系統 PATH
4. 安裝穩定版 Rust 工具鏈

**驗證安裝：**
```bash
rustc --version
cargo --version
```

你應該看到類似這樣的輸出：
```
rustc 1.75.0 (82e1608df 2023-12-21)
cargo 1.75.0 (1d8b05cdd 2023-11-20)
```

### 步驟 2：安裝程式碼編輯器

**推薦：VS Code + rust-analyzer**

1. 安裝 [VS Code](https://code.visualstudio.com/)
2. 安裝 `rust-analyzer` 擴充功能（注意不是 "Rust" - 要用 rust-analyzer）
3. 安裝 `CodeLLDB` 用於除錯支援

**其他編輯器：**
- IntelliJ IDEA 配合 Rust 外掛
- Vim/Neovim 配合 rust-tools.nvim
- Emacs 配合 rust-mode

rust-analyzer 提供：
- ✅ 自動補全
- ✅ 內聯型別提示
- ✅ 轉到定義
- ✅ 內聯錯誤訊息
- ✅ 程式碼操作（快速修復）

## 你的第一個 Rust 程式

讓我們建立並執行你的第一個 Rust 專案！

### 建立新專案

```bash
cargo new hello_rust
cd hello_rust
```

Cargo 建立：
```
hello_rust/
├── Cargo.toml      # 專案元資料和依賴
└── src/
    └── main.rs     # 你的原始碼
```

### 理解專案結構

**`Cargo.toml`** - 專案清單：
```toml
[package]
name = "hello_rust"
version = "0.1.0"
edition = "2021"

[dependencies]
# 外部 crate 放在這裡
```

**`src/main.rs`** - 進入點：
```rust
fn main() {
    println!("Hello, world!");
}
```

### 執行你的專案

```bash
cargo run
```

你應該看到：
```
Compiling hello_rust v0.1.0
Finished dev profile [unoptimized + debuginfo] target(s)
Running `target/debug/hello_rust`
Hello, world!
```

## 理解程式碼

讓我們分解發生了什麼：

<UniversalEditor compare={true} title="Hello World：Python vs Rust">
```python !! py
# Python: 腳本式執行
# 不需要 main 函式 - 只是從上到下執行

def main():
    print("Hello, world!")

if __name__ == "__main__":
    main()

# 實際上，在 Python 中通常只需：
print("Hello, world!")
```

```rust !! rs
// Rust: 編譯型，有顯式進入點
// 每個 Rust 程式都需要 main() 函式

fn main() {  // fn 宣告函式
    println!("Hello, world!");  // ! 表示巨集
}

// 關鍵點：
// - fn: 函式關鍵字
// - main(): 進入點（類似 if __name__ == "__main__"）
// - {}: 函式主體
// - println!: 巨集呼叫（注意 !）
// - ;: 陳述式終止符
```
</UniversalEditor>

### 關鍵 Rust 概念（預覽）

1. **`fn main()`**: 進入點函式
2. **`println!`**: 它是 **巨集**（注意 `!`），不是函式
3. **`;`**: 陳述式必須以分號結尾
4. **`{}`**: 用於作用域的程式碼塊

## Cargo 命令深入

Cargo 是 Rust 開發的瑞士軍刀：

### 建構命令

```bash
# 開發版本建構（未最佳化，快速編譯）
cargo build

# 發佈版本建構（最佳化後，慢速編譯，快速二進位）
cargo build --release

# 立即執行（必要時建構）
cargo run

# 執行發佈版本
cargo run --release
```

### 開發命令

```bash
# 檢查程式碼而不建構（最快）
cargo check

# 執行測試
cargo test

# 產生文件
cargo doc --open

# 建立新專案（二進位）
cargo new project_name

# 建立新專案（函式庫）
cargo new --lib project_name

# 更新依賴
cargo update
```

### 有用的 Cargo 標誌

```bash
# 顯示詳細輸出
cargo build --verbose

# 僅編譯特定目標
cargo build --bin hello_rust

# 編譯特定範例
cargo build --example my_example

# 使用自訂參數執行
cargo run -- --some-arg
```

## Python 和 Rust 工作流程對比

<UniversalEditor compare={true} title="專案結構對比">
```python !! py
# Python 專案結構
myproject/
├── src/
│   └── mymodule.py
├── tests/
│   └── test_mymodule.py
├── requirements.txt
├── setup.py 或 pyproject.toml
└── README.md

# 安裝依賴
pip install -r requirements.txt

# 執行模組
python -m src.mymodule

# 執行測試
pytest

# 打包
python setup.py sdist
```

```rust !! rs
// Rust 專案結構
myproject/
├── src/
│   ├── main.rs       # 二進位進入點
│   └── lib.rs        # 函式庫進入點（如果是 --lib）
├── tests/
│   └── integration_test.rs
├── examples/
│   └── example.rs
├── Cargo.toml        # 所有依賴在這裡
└── README.md

// 建構和執行
cargo build
cargo run
cargo test

// 一切都由 Cargo 管理
```
</UniversalEditor>

## 設定開發環境

### 推薦的 VS Code 擴充功能

1. **rust-analyzer**（必需）
   - 官方語言伺服器
   - 提供 IDE 功能

2. **CodeLLDB**
   - 除錯支援

3. **Even Better TOML**
   - Cargo.toml 的語法高亮

4. **Error Lens**
   - 內聯錯誤顯示

### VS Code 設定

建立 `.vscode/settings.json`：
```json
{
    "rust-analyzer.checkOnSave.command": "clippy",
    "rust-analyzer.cargo.features": "all",
    "editor.formatOnSave": true,
    "rust-analyzer.rustfmt.extraArgs": ["+nightly"]
}
```

## Rust 編譯模型

理解 Rust 如何編譯有助於你有效地使用它。

<UniversalEditor compare={true} title="執行模型：Python vs Rust">
```python !! py
# Python: 直譯型
# 原始碼 → 位元組碼 (.pyc) → Python VM → 執行

def add(a, b):
    return a + b

# 逐行執行
# 型別錯誤發生在執行時
# 無編譯步驟（技術上有位元組碼編譯）
```

```rust !! rs
// Rust: 提前編譯
// 原始碼 → LLVM IR → 機器碼 → 執行

fn add(a: i32, b: i32) -> i32 {
    a + b
}

// 執行前完全編譯
// 編譯時捕獲型別錯誤
// 產生原生可執行檔
```
</UniversalEditor>

### 編譯過程

1. **解析**: Rust 原始碼 → AST（抽象語法樹）
2. **HIR 降低**: AST → HIR（高階中間表示）
3. **MIR 降低**: HIR → MIR（中階中間表示）
4. **LLVM**: MIR → LLVM IR → 機器碼
5. **鏈接**: 機器碼 + 函式庫 → 可執行檔

這就是為什麼 `cargo build` 比 `python script.py` 花費更長時間，但產生的二進位檔執行速度快得多。

## 基本 Rust 語法（快速預覽）

讓我們看一下與 Python 對比的一些基本 Rust 語法：

### 變數

<UniversalEditor compare={true} title="變數：Python vs Rust">
```python !! py
# Python: 動態型別，預設可變
name = "Alice"       # string
age = 25             # int
height = 5.6         # float

# 可以重新賦值為不同型別
name = 42  # 這可以！

# 一切都可變
age = 26
```

```rust !! rs
// Rust: 靜態型別，預設不可變
let name = "Alice";   // &str
let age: i32 = 25;    // i32（顯式型別）
let height = 5.6;     // f64（推斷）

// 不能重新賦值為不同型別
// name = 42;  // 錯誤：型別不匹配

// 變數預設不可變
// age = 26;  // 錯誤：不能賦值兩次

// 使用 mut 表示可變變數
let mut age = 25;
age = 26;  // 可以
```
</UniversalEditor>

### 函式

<UniversalEditor compare={true} title="函式：Python vs Rust">
```python !! py
# Python: 動態型別，可選回傳型別
def greet(name, age):
    message = f"Hello, {name}!"
    print(message)
    return age * 2

# 呼叫
result = greet("Alice", 25)
```

```rust !! rs
// Rust: 靜態型別，顯式回傳型別
fn greet(name: &str, age: i32) -> i32 {
    let message = format!("Hello, {}!", name);
    println!("{}", message);
    age * 2  // 無分號 = 回傳值
}

// 呼叫
let result = greet("Alice", 25);
```
</UniversalEditor>

## Rust 版本

Rust 有"版本"（editions），允許漸進式改進：

- **Rust 2015**: 原始版本
- **Rust 2018**: 重大改進（模組、非同步準備）
- **Rust 2021**: 當前版本（預設）

新專案應該使用 Rust 2021。所有版本可以一起工作 - 你可以在 Rust 2021 專案中使用 Rust 2015 crate。

## Rust 社群

Rust 擁有最友善的程式設計社群之一：

### 官方資源
- **Rust 程式設計語言**: [doc.rust-lang.org/book](https://doc.rust-lang.org/book/) （"Rust 書"）
- **Rust by Example**: [doc.rust-lang.org/rust-by-example](https://doc.rust-lang.org/rust-by-example/)
- **Rust 標準函式庫**: [doc.rust-lang.org/std](https://doc.rust-lang.org/std/)

### 社群資源
- **Rust 使用者論壇**: [users.rust-lang.org](https://users.rust-lang.org/)
- **Rust Discord**: [discord.gg/rust-lang](https://discord.gg/rust-lang)
- **Reddit**: r/rust
- **Crates.io**: [crates.io](https://crates.io/)（套件註冊表）

## 常見的初次挑戰

### 1. 借用檢查器

你會經常遇到這個錯誤：
```rust
let s1 = String::from("hello");
let s2 = s1;
// println!("{}", s1);  // 錯誤：值移動後被借用
```

這是 Rust 的所有權系統防止移動後使用。我們將在模組 2 中詳細講解。

### 2. 冗長性

Rust 比 Python 更冗長：
```rust
// Rust: 到處都是顯式型別
fn process(items: Vec<i32>) -> Vec<i32> {
    items.into_iter().map(|x| x * 2).collect()
}
```

這種冗長性換來的是安全性和效能。你會學會欣賞它。

### 3. 編譯時間

Rust 編譯比 Python 執行慢。提示：
- 使用 `cargo check` 進行快速驗證
- 僅在需要時使用 `cargo build`
- 編譯器正在捕獲你在 Python 中執行時才會發現的錯誤

## 你的第二個 Rust 程式

讓我們寫一些更有趣的東西：

<UniversalEditor compare={true} title="斐波那契：Python vs Rust">
```python !! py
def fibonacci(n):
    """計算第 n 個斐波那契數。"""
    if n <= 1:
        return n
    a, b = 0, 1
    for _ in range(2, n + 1):
        a, b = b, a + b
    return b

if __name__ == "__main__":
    n = 10
    result = fibonacci(n)
    print(f"斐波那契({n}) = {result}")
```

```rust !! rs
fn fibonacci(n: u64) -> u64 {
    /// 計算第 n 個斐波那契數
    if n <= 1 {
        return n;
    }
    let (mut a, mut b) = (0, 1);
    for _ in 2..=n {
        let temp = a + b;
        a = b;
        b = temp;
    }
    b
}

fn main() {
    let n = 10;
    let result = fibonacci(n);
    println!("斐波那契({}) = {}", n, result);
}
```
</UniversalEditor>

在 `src/main.rs` 中建立此檔案並使用 `cargo run` 執行。

## 測試你的安裝

驗證一切正常：

```bash
# 檢查 Rust 版本
rustc --version

# 檢查 Cargo
cargo --version

# 建立測試專案
cargo new test_project && cd test_project

# 建構它
cargo build

# 執行它
cargo run

# 執行測試
cargo test
```

如果所有指令都成功，你就準備好學習 Rust 了！

## 總結

在本模組中，你學習了：
- ✅ 為什麼 Rust 對 Python 開發者有價值
- ✅ 如何安裝 Rust 和 Cargo
- ✅ 如何建立和執行 Rust 專案
- ✅ 基本 Cargo 命令
- ✅ Python 直譯和 Rust 編譯的區別
- ✅ 如何設定開發環境

## 下一步

現在環境已設定好：
1. **[模組 1：語法基礎](./module-01-syntax-basics)** - 透過與 Python 對比學習 Rust 語法
2. 用小程式練習
3. 探索 [Rust Playground](https://play.rust-lang.org/) 進行快速實驗

## 練習

### 練習 1：建立專案

建立一個名為 `greeting` 的 Cargo 專案，要求：
- 詢問使用者的名字
- 列印個人化問候
- 使用變數和函式

### 練習 2：溫度轉換器

編寫一個將華氏度轉換為攝氏度的程式：
- 公式：`C = (F - 32) * 5/9`
- 為轉換建立函式
- 用幾個值測試

<details>
<summary>解答</summary>

```rust
fn fahrenheit_to_celsius(f: f64) -> f64 {
    (f - 32.0) * 5.0 / 9.0
}

fn main() {
    let fahrenheit = 98.6;
    let celsius = fahrenheit_to_celsius(fahrenheit);
    println!("{}°F = {}°C", fahrenheit, celsius);
}
```

</details>

---

**記住**：Rust 有學習曲線，但編譯器是你的朋友。仔細閱讀錯誤訊息 - 它們非常有幫助！

**下一步**：[模組 1 - 語法基礎](./module-01-syntax-basics) →
