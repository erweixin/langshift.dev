---
title: "模組 13: 模組與包 - 代碼組織"
description: "學習 Rust 的模組系統、如何使用 Cargo.toml 組織代碼,以及發布包到 crates.io,與 Python 的打包生態系統進行比較。"
---

# 模組 13: 模組與包 - 代碼組織

在本模組中,你將學習 Rust 如何將代碼組織成**模組**和**包**,以及這與 Python 的導入系統和包管理的比較。

## 學習目標

完成本模組後,你將能夠:
- 理解 Rust 的模組系統
- 使用 `mod`、`use` 和 `pub` 關鍵字
- 使用文件層次結構組織代碼
- 使用 Cargo.toml 進行依賴管理
- 從 crates.io 發布和消費包
- 比較 Rust 的打包與 Python 的 setuptools/PyPI

## 模組系統基礎

Rust 的模組系統提供**命名空間**和**訪問控制**。與 Python 的隱式模組系統不同,Rust 的是顯式的和基於文件的。

### 定義模組

<UniversalEditor compare={true} title="模組定義">
```python !! py
# Python: 模組本身就是文件
# math_utils.py
def add(a, b):
    return a + b

# 使用:
# from math_utils import add
# result = add(1, 2)
```

```rust !! rs
// Rust: 模組是顯式聲明的
// math_utils.rs
pub fn add(a: i32, b: i32) -> i32 {
    a + b
}

// 在 main.rs 或 lib.rs 中:
mod math_utils;  // 聲明模組

fn main() {
    let result = math_utils::add(1, 2);
    println!("Result: {}", result);
}
```
</UniversalEditor>

## Use 聲明

`use` 關鍵字將項引入作用域,類似於 Python 的 `import`。

<UniversalEditor compare={true} title="Import vs Use">
```python !! py
# Python: 導入語句
import os
from collections import defaultdict
```

```rust !! rs
// Rust: Use 聲明
use std::fs;  // 類似於: import fs
use std::collections::HashMap;  // 類似於: from collections import HashMap

fn main() {
    let path = fs::File::create("test.txt").unwrap();
}
```
</UniversalEditor>

## Cargo.toml 和依賴

`Cargo.toml` 類似於 Python 的 `pyproject.toml`,但更具規範性。

<UniversalEditor compare={true} title="包配置">
```python !! py
# Python: pyproject.toml
[project]
name = "mypackage"
version = "1.0.0"
dependencies = [
    "requests>=2.28.0",
]
```

```rust !! rs
// Rust: Cargo.toml
[package]
name = "mycrate"
version = "0.1.0"
edition = "2021"

[dependencies]
serde = { version = "1.0", features = ["derive"] }
tokio = { version = "1.0" }
```
</UniversalEditor>

## 發布到 crates.io

<UniversalEditor compare={true} title="發布包">
```python !! py
# Python: 發布到 PyPI
python -m build
twine upload dist/*
```

```rust !! rs
// Rust: 發布到 crates.io
cargo login
cargo publish
```
</UniversalEditor>

## 最佳實踐

### 應該做:

1. **使用模組組織代碼** - 分組相關功能
2. **使 API 公開,實現私有** - 封裝
3. **使用 `pub use` 提供便利** - 重新導出常見項

### 不應該做:

1. **過度使用 `use *`** - 明確導入
2. **使所有內容公開** - 尊重封裝

## 總結

- **模組**提供命名空間組織
- **Use** 聲明將項引入作用域
- **Cargo.toml** 是依賴的唯一真實來源
- **crates.io** 是官方包註冊表
- **Rust 的系統**比 Python 的更顯式

## 下一模組

在下一個模組中,我們將探索**文件 I/O 和標準庫**,包括讀/寫文件、路徑操作、命令行參數和環境變量。你將學習 Rust 的方法如何與 Python 的文件處理進行比較。
