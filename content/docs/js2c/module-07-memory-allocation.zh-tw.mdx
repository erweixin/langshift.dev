---
title: "å‹•æ…‹è¨˜æ†¶é«”åˆ†é…"
description: "å¾ JavaScript è¦–è§’å­¸ç¿’ C èªè¨€å‹•æ…‹è¨˜æ†¶é«”åˆ†é…ï¼Œç†è§£ mallocã€freeã€è¨˜æ†¶é«”æ´©æ¼ï¼Œä¸¦å°æ¯” JavaScript åƒåœ¾å›æ”¶æ©Ÿåˆ¶ã€‚"
---

# å‹•æ…‹è¨˜æ†¶é«”åˆ†é…

## 1. æ¦‚å¿µä»‹ç´¹

### å¾ JavaScript åƒåœ¾å›æ”¶åˆ° C æ‰‹å‹•è¨˜æ†¶é«”ç®¡ç†

åœ¨ JavaScript ä¸­ï¼Œè¨˜æ†¶é«”ç®¡ç†æ˜¯è‡ªå‹•çš„ - åƒåœ¾å›æ”¶å™¨æœƒè‡ªå‹•é‡‹æ”¾æœªä½¿ç”¨çš„è¨˜æ†¶é«”ã€‚è€Œåœ¨ C èªè¨€ä¸­ï¼Œä½ å¿…é ˆæ‰‹å‹•ä½¿ç”¨ `malloc()`ã€`calloc()`ã€`realloc()` å’Œ `free()` ç­‰å‡½æ•¸ä¾†åˆ†é…å’Œé‡‹æ”¾è¨˜æ†¶é«”ã€‚

> ğŸ’¡ **æ ¸å¿ƒæ¦‚å¿µ**ï¼šC çš„æ‰‹å‹•è¨˜æ†¶é«”ç®¡ç†çµ¦ä½ ç²¾ç¢ºçš„æ§åˆ¶æ¬Šï¼Œä½†éœ€è¦ä»”ç´°æ³¨æ„ä»¥é˜²æ­¢è¨˜æ†¶é«”æ´©æ¼å’Œæœªå®šç¾©è¡Œç‚ºã€‚

## 2. åŸºç¤è¨˜æ†¶é«”åˆ†é…

<UniversalEditor title="åŸºç¤è¨˜æ†¶é«”åˆ†é…" compare={true}>
```javascript !! js
// JavaScript - è‡ªå‹•è¨˜æ†¶é«”ç®¡ç†
let arr = [1, 2, 3, 4, 5];
arr.push(6); // é™£åˆ—è‡ªå‹•å¢é•·
arr = null; // è¨˜æ†¶é«”å°‡è¢«åƒåœ¾å›æ”¶

// å‹•æ…‹ç‰©ä»¶å»ºç«‹
let obj = { name: "Alice", age: 30 };
obj = null; // ç‰©ä»¶å°‡è¢«åƒåœ¾å›æ”¶

// ç„¡éœ€æ‰‹å‹•è¨˜æ†¶é«”ç®¡ç†
```

```c !! c
#include <stdio.h>
#include <stdlib.h>

int main() {
    // ç‚ºæ•´æ•¸åˆ†é…è¨˜æ†¶é«”
    int* ptr = (int*)malloc(sizeof(int));
    if (ptr == NULL) {
        printf("è¨˜æ†¶é«”åˆ†é…å¤±æ•—ï¼\n");
        return 1;
    }
    
    *ptr = 42;
    printf("å€¼: %d\n", *ptr);
    
    // å§‹çµ‚é‡‹æ”¾åˆ†é…çš„è¨˜æ†¶é«”
    free(ptr);
    ptr = NULL; // è‰¯å¥½å¯¦è¸ï¼Œé¿å…æ‡¸ç©ºæŒ‡æ¨™
    
    // ç‚ºé™£åˆ—åˆ†é…è¨˜æ†¶é«”
    int* arr = (int*)malloc(5 * sizeof(int));
    if (arr == NULL) {
        printf("é™£åˆ—åˆ†é…å¤±æ•—ï¼\n");
        return 1;
    }
    
    // åˆå§‹åŒ–é™£åˆ—
    for (int i = 0; i < 5; i++) {
        arr[i] = i + 1;
    }
    
    // ä½¿ç”¨é™£åˆ—
    for (int i = 0; i < 5; i++) {
        printf("%d ", arr[i]);
    }
    printf("\n");
    
    // é‡‹æ”¾é™£åˆ—è¨˜æ†¶é«”
    free(arr);
    arr = NULL;
    
    return 0;
}
```
</UniversalEditor>

## 3. é€²éšè¨˜æ†¶é«”å‡½æ•¸

<UniversalEditor title="é€²éšè¨˜æ†¶é«”å‡½æ•¸" compare={true}>
```javascript !! js
// JavaScript - å‹•æ…‹é™£åˆ—å’Œç‰©ä»¶
let numbers = [];
for (let i = 0; i < 10; i++) {
    numbers.push(i);
}

// é™£åˆ—è‡ªå‹•èª¿æ•´å¤§å°
numbers.length = 20; // æ“´å±•é™£åˆ—
numbers.length = 5;  // æˆªæ–·é™£åˆ—

// ç‰©ä»¶å±¬æ€§å¯ä»¥å‹•æ…‹æ–°å¢/åˆªé™¤
let person = {};
person.name = "Bob";
person.age = 25;
delete person.age;
```

```c !! c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main() {
    // calloc - åˆ†é…ä¸¦åˆå§‹åŒ–ç‚ºé›¶
    int* zeros = (int*)calloc(5, sizeof(int));
    if (zeros == NULL) {
        printf("calloc å¤±æ•—ï¼\n");
        return 1;
    }
    
    printf("calloc åˆå§‹åŒ–çš„å€¼: ");
    for (int i = 0; i < 5; i++) {
        printf("%d ", zeros[i]); // å…¨ç‚ºé›¶
    }
    printf("\n");
    
    // realloc - èª¿æ•´ç¾æœ‰åˆ†é…çš„å¤§å°
    int* resized = (int*)realloc(zeros, 10 * sizeof(int));
    if (resized == NULL) {
        printf("realloc å¤±æ•—ï¼\n");
        free(zeros);
        return 1;
    }
    
    // åˆå§‹åŒ–æ–°å…ƒç´ 
    for (int i = 5; i < 10; i++) {
        resized[i] = i;
    }
    
    printf("realloc å¾Œ: ");
    for (int i = 0; i < 10; i++) {
        printf("%d ", resized[i]);
    }
    printf("\n");
    
    free(resized);
    
    return 0;
}
```
</UniversalEditor>

## 4. è¨˜æ†¶é«”æ´©æ¼å’Œé é˜²

<UniversalEditor title="è¨˜æ†¶é«”æ´©æ¼é é˜²" compare={true}>
```javascript !! js
// JavaScript - è‡ªå‹•æ¸…ç†
function createObjects() {
    let obj = { data: "é‡è¦è³‡æ–™" };
    // obj åœ¨å‡½æ•¸çµæŸæ™‚å°‡è¢«åƒåœ¾å›æ”¶
    // ç„¡éœ€æ‰‹å‹•æ¸…ç†
}

// å³ä½¿æœ‰å¾ªç’°åƒè€ƒï¼Œåƒåœ¾å›æ”¶å™¨ä¹Ÿèƒ½è™•ç†
let obj1 = { name: "Alice" };
let obj2 = { name: "Bob" };
obj1.friend = obj2;
obj2.friend = obj1;
// å¾ªç’°åƒè€ƒå°‡è¢«æª¢æ¸¬ä¸¦æ¸…ç†
```

```c !! c
#include <stdio.h>
#include <stdlib.h>

// éŒ¯èª¤ï¼šè¨˜æ†¶é«”æ´©æ¼ - åˆ†é…çš„è¨˜æ†¶é«”æœªé‡‹æ”¾
void badFunction() {
    int* ptr = (int*)malloc(sizeof(int));
    *ptr = 42;
    // è¨˜æ†¶é«”æ´©æ¼ï¼šptr æœªé‡‹æ”¾ï¼
    // ptr è¶…å‡ºä½œç”¨åŸŸï¼Œè¨˜æ†¶é«”ä¸Ÿå¤±
}

// æ­£ç¢ºï¼šé©ç•¶çš„è¨˜æ†¶é«”ç®¡ç†
void goodFunction() {
    int* ptr = (int*)malloc(sizeof(int));
    if (ptr == NULL) {
        return; // è™•ç†åˆ†é…å¤±æ•—
    }
    
    *ptr = 42;
    printf("å€¼: %d\n", *ptr);
    
    free(ptr); // å§‹çµ‚é‡‹æ”¾åˆ†é…çš„è¨˜æ†¶é«”
    ptr = NULL; // é˜²æ­¢æ‡¸ç©ºæŒ‡æ¨™
}

// è¨˜æ†¶é«”æ´©æ¼æª¢æ¸¬æ¨¡å¼
void safeAllocation() {
    int* ptr = NULL;
    
    ptr = (int*)malloc(sizeof(int));
    if (ptr == NULL) {
        printf("åˆ†é…å¤±æ•—\n");
        return;
    }
    
    // ä½¿ç”¨è¨˜æ†¶é«”
    *ptr = 100;
    
    // æ¸…ç†
    free(ptr);
    ptr = NULL;
}

int main() {
    goodFunction();
    safeAllocation();
    return 0;
}
```
</UniversalEditor>

## 5. å¸¸è¦‹é™·é˜±
- **è¨˜æ†¶é«”æ´©æ¼**ï¼šå¿˜è¨˜å‘¼å« `free()`
- **é‡è¤‡é‡‹æ”¾**ï¼šå°å·²é‡‹æ”¾çš„è¨˜æ†¶é«”å†æ¬¡å‘¼å« `free()`
- **æ‡¸ç©ºæŒ‡æ¨™**ï¼šé‡‹æ”¾è¨˜æ†¶é«”å¾Œä»ä½¿ç”¨æŒ‡æ¨™
- **ç·©è¡å€æº¢ä½**ï¼šå¯«å…¥è¶…å‡ºåˆ†é…è¨˜æ†¶é«”çš„ç¯„åœ
- **ç©ºæŒ‡æ¨™è§£åƒè€ƒ**ï¼šæœªæª¢æŸ¥ `malloc()` æ˜¯å¦è¿”å› NULL

## 6. ç·´ç¿’é¡Œ
1. æ’°å¯«ä¸€å€‹å‡½æ•¸ï¼Œç‚ºå­—ä¸²åˆ†é…è¨˜æ†¶é«”ï¼Œè¤‡è£½çµ¦å®šå­—ä¸²åˆ°å…¶ä¸­ï¼Œä¸¦è¿”å›æŒ‡æ¨™ã€‚è¨˜å¾—ç¨å¾Œé‡‹æ”¾å®ƒã€‚
2. å»ºç«‹ä¸€å€‹å‡½æ•¸ï¼Œå‹•æ…‹åˆ†é…äºŒç¶­é™£åˆ—ä¸¦ç”¨å€¼åˆå§‹åŒ–å®ƒã€‚
3. æ’°å¯«ä¸€å€‹ç¨‹å¼ï¼Œé€éè¿½è¹¤åˆ†é…å’Œé‡‹æ”¾ä¾†ç¤ºç¯„è¨˜æ†¶é«”æ´©æ¼æª¢æ¸¬ã€‚

## 7. æ•ˆèƒ½åˆ†æ
- æ‰‹å‹•è¨˜æ†¶é«”ç®¡ç†å¯èƒ½æ¯”åƒåœ¾å›æ”¶æ›´é«˜æ•ˆ
- é »ç¹çš„åˆ†é…/é‡‹æ”¾å¯èƒ½å°è‡´è¨˜æ†¶é«”ç¢ç‰‡
- è¨˜æ†¶é«”æ± å¯ä»¥æé«˜å°è¦æ¨¡é »ç¹åˆ†é…çš„æ€§èƒ½
- é©ç•¶çš„è¨˜æ†¶é«”ç®¡ç†å°é•·æ™‚é–“åŸ·è¡Œçš„æ‡‰ç”¨ç¨‹å¼è‡³é—œé‡è¦

---

> **å°çµ**ï¼šC çš„æ‰‹å‹•è¨˜æ†¶é«”ç®¡ç†æä¾›æ§åˆ¶å’Œæ€§èƒ½ï¼Œä½†éœ€è¦ç´€å¾‹æ€§ã€‚å§‹çµ‚å°‡ `malloc()` èˆ‡ `free()` é…å°ï¼Œæª¢æŸ¥åˆ†é…å¤±æ•—ï¼Œä¸¦ä½¿ç”¨ Valgrind ç­‰å·¥å…·æª¢æ¸¬è¨˜æ†¶é«”æ´©æ¼ã€‚ 