---
title: "æ–‡ä»¶æ“ä½œå’Œ I/O"
description: "ä» JavaScript è§†è§’å­¦ä¹  C è¯­è¨€æ–‡ä»¶æ“ä½œï¼Œç†è§£æ–‡ä»¶ I/Oã€é”™è¯¯å¤„ç†ï¼Œå¹¶å¯¹æ¯” JavaScript File APIã€‚"
---

# æ–‡ä»¶æ“ä½œå’Œ I/O

## 1. æ¦‚å¿µä»‹ç»

### ä» JavaScript File API åˆ° C æ–‡ä»¶æ“ä½œ

åœ¨ JavaScript ä¸­ï¼Œæ–‡ä»¶æ“ä½œé€šå¸¸æ˜¯å¼‚æ­¥çš„ï¼Œé€šè¿‡ File API æˆ– Node.js fs æ¨¡å—å¤„ç†ã€‚è€Œåœ¨ C è¯­è¨€ä¸­ï¼Œæ–‡ä»¶æ“ä½œæ˜¯åŒæ­¥çš„ï¼Œä½¿ç”¨åº•å±‚ç³»ç»Ÿè°ƒç”¨ï¼Œæä¾›å¯¹æ–‡ä»¶å¤„ç†çš„ç›´æ¥æ§åˆ¶ã€‚

> ğŸ’¡ **æ ¸å¿ƒæ¦‚å¿µ**ï¼šC æ–‡ä»¶æ“ä½œç»™ä½ å¯¹æ–‡ä»¶ I/O çš„ç²¾ç¡®æ§åˆ¶ï¼Œä½†éœ€è¦ä»”ç»†çš„é”™è¯¯å¤„ç†å’Œèµ„æºç®¡ç†ã€‚

## 2. åŸºç¡€æ–‡ä»¶æ“ä½œ

<UniversalEditor title="åŸºç¡€æ–‡ä»¶æ“ä½œ" compare={true}>
```javascript !! js
// JavaScript - File API (æµè§ˆå™¨)
const fileInput = document.getElementById('fileInput');
fileInput.addEventListener('change', (event) => {
    const file = event.target.files[0];
    const reader = new FileReader();
    
    reader.onload = function(e) {
        console.log('æ–‡ä»¶å†…å®¹:', e.target.result);
    };
    
    reader.readAsText(file);
});

// Node.js fs æ¨¡å—
const fs = require('fs');

// åŒæ­¥è¯»å–
try {
    const data = fs.readFileSync('input.txt', 'utf8');
    console.log('æ–‡ä»¶å†…å®¹:', data);
} catch (err) {
    console.error('è¯»å–æ–‡ä»¶é”™è¯¯:', err);
}

// å¼‚æ­¥è¯»å–
fs.readFile('input.txt', 'utf8', (err, data) => {
    if (err) {
        console.error('é”™è¯¯:', err);
        return;
    }
    console.log('æ–‡ä»¶å†…å®¹:', data);
});
```

```c !! c
#include <stdio.h>
#include <stdlib.h>

int main() {
    FILE* file;
    char buffer[1024];
    
    // ä»¥è¯»å–æ¨¡å¼æ‰“å¼€æ–‡ä»¶
    file = fopen("input.txt", "r");
    if (file == NULL) {
        printf("é”™è¯¯ï¼šæ— æ³•ä»¥è¯»å–æ¨¡å¼æ‰“å¼€æ–‡ä»¶\n");
        return 1;
    }
    
    // è¯»å–æ–‡ä»¶å†…å®¹
    while (fgets(buffer, sizeof(buffer), file) != NULL) {
        printf("è¡Œ: %s", buffer);
    }
    
    // å…³é—­æ–‡ä»¶
    fclose(file);
    
    // å†™å…¥æ–‡ä»¶
    file = fopen("output.txt", "w");
    if (file == NULL) {
        printf("é”™è¯¯ï¼šæ— æ³•ä»¥å†™å…¥æ¨¡å¼æ‰“å¼€æ–‡ä»¶\n");
        return 1;
    }
    
    fprintf(file, "ä½ å¥½ï¼ŒC æ–‡ä»¶æ“ä½œï¼\n");
    fprintf(file, "è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶ã€‚\n");
    
    fclose(file);
    printf("æ–‡ä»¶å†™å…¥æˆåŠŸ\n");
    
    return 0;
}
```
</UniversalEditor>

## 3. æ–‡ä»¶æ¨¡å¼å’Œæ“ä½œ

<UniversalEditor title="æ–‡ä»¶æ¨¡å¼" compare={true}>
```javascript !! js
// JavaScript - ä¸åŒçš„æ–‡ä»¶æ“ä½œ
const fs = require('fs');

// è¯»å–æ–‡ä»¶
fs.readFile('data.txt', 'utf8', (err, data) => {
    if (err) throw err;
    console.log(data);
});

// å†™å…¥æ–‡ä»¶ï¼ˆè¦†ç›–ï¼‰
fs.writeFile('output.txt', 'æ–°å†…å®¹', (err) => {
    if (err) throw err;
    console.log('æ–‡ä»¶å·²å†™å…¥');
});

// è¿½åŠ åˆ°æ–‡ä»¶
fs.appendFile('log.txt', 'æ–°æ—¥å¿—æ¡ç›®\n', (err) => {
    if (err) throw err;
    console.log('å·²è¿½åŠ åˆ°æ–‡ä»¶');
});

// æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
if (fs.existsSync('data.txt')) {
    console.log('æ–‡ä»¶å­˜åœ¨');
}
```

```c !! c
#include <stdio.h>
#include <stdlib.h>

int main() {
    FILE* file;
    
    // ä¸åŒçš„æ–‡ä»¶æ¨¡å¼
    // "r" - åªè¯»
    // "w" - å†™å…¥ï¼ˆåˆ›å»ºæ–°æ–‡ä»¶ï¼Œæˆªæ–­ç°æœ‰æ–‡ä»¶ï¼‰
    // "a" - è¿½åŠ 
    // "r+" - è¯»å†™
    // "w+" - è¯»å†™ï¼ˆåˆ›å»ºæ–°æ–‡ä»¶ï¼‰
    // "a+" - è¯»å’Œè¿½åŠ 
    
    // è¯»å–æ¨¡å¼
    file = fopen("data.txt", "r");
    if (file != NULL) {
        printf("æ–‡ä»¶å·²ä»¥è¯»å–æ¨¡å¼æ‰“å¼€\n");
        fclose(file);
    }
    
    // å†™å…¥æ¨¡å¼ï¼ˆè¦†ç›–ï¼‰
    file = fopen("output.txt", "w");
    if (file != NULL) {
        fprintf(file, "è¿™ä¼šè¦†ç›–æ–‡ä»¶\n");
        fclose(file);
    }
    
    // è¿½åŠ æ¨¡å¼
    file = fopen("log.txt", "a");
    if (file != NULL) {
        fprintf(file, "æ–°æ—¥å¿—æ¡ç›®\n");
        fclose(file);
    }
    
    // è¯»å†™æ¨¡å¼
    file = fopen("data.txt", "r+");
    if (file != NULL) {
        // å¯ä»¥åŒæ—¶è¯»å†™
        char buffer[100];
        fgets(buffer, sizeof(buffer), file);
        printf("è¯»å–: %s", buffer);
        
        fseek(file, 0, SEEK_END); // è·³åˆ°æœ«å°¾
        fprintf(file, "è¿½åŠ çš„å†…å®¹\n");
        fclose(file);
    }
    
    return 0;
}
```
</UniversalEditor>

## 4. é”™è¯¯å¤„ç†å’Œæ–‡ä»¶å®šä½

<UniversalEditor title="é”™è¯¯å¤„ç†" compare={true}>
```javascript !! js
// JavaScript - é”™è¯¯å¤„ç†
const fs = require('fs');

function readFileSafely(filename) {
    try {
        const data = fs.readFileSync(filename, 'utf8');
        return data;
    } catch (error) {
        if (error.code === 'ENOENT') {
            console.log('æ–‡ä»¶æœªæ‰¾åˆ°');
        } else if (error.code === 'EACCES') {
            console.log('æƒé™è¢«æ‹’ç»');
        } else {
            console.log('é”™è¯¯:', error.message);
        }
        return null;
    }
}

// æ–‡ä»¶å®šä½ï¼ˆNode.js Bufferï¼‰
const buffer = Buffer.alloc(1024);
const fd = fs.openSync('data.txt', 'r');
fs.readSync(fd, buffer, 0, 100, 50); // ä»ä½ç½® 50 å¼€å§‹è¯»å– 100 å­—èŠ‚
fs.closeSync(fd);
```

```c !! c
#include <stdio.h>
#include <stdlib.h>
#include <errno.h>
#include <string.h>

int main() {
    FILE* file;
    char buffer[1024];
    
    // æ‰“å¼€æ–‡ä»¶å¹¶è¿›è¡Œé”™è¯¯æ£€æŸ¥
    file = fopen("ä¸å­˜åœ¨çš„æ–‡ä»¶.txt", "r");
    if (file == NULL) {
        printf("æ‰“å¼€æ–‡ä»¶é”™è¯¯: %s\n", strerror(errno));
        
        // æ£€æŸ¥ç‰¹å®šé”™è¯¯ç±»å‹
        if (errno == ENOENT) {
            printf("æ–‡ä»¶ä¸å­˜åœ¨\n");
        } else if (errno == EACCES) {
            printf("æƒé™è¢«æ‹’ç»\n");
        }
        return 1;
    }
    
    // æ–‡ä»¶å®šä½
    fseek(file, 0, SEEK_SET);   // æ–‡ä»¶å¼€å¤´
    fseek(file, 0, SEEK_END);   // æ–‡ä»¶æœ«å°¾
    fseek(file, 10, SEEK_CUR);  // ä»å½“å‰ä½ç½®å‘å 10 å­—èŠ‚
    
    // è·å–å½“å‰ä½ç½®
    long position = ftell(file);
    printf("å½“å‰ä½ç½®: %ld\n", position);
    
    // è¯»å–æŒ‡å®šæ•°é‡
    size_t bytes_read = fread(buffer, 1, 100, file);
    if (bytes_read < 100) {
        if (feof(file)) {
            printf("å·²åˆ°è¾¾æ–‡ä»¶æœ«å°¾\n");
        }
        if (ferror(file)) {
            printf("è¯»å–æ–‡ä»¶é”™è¯¯\n");
        }
    }
    
    fclose(file);
    return 0;
}
```
</UniversalEditor>

## 5. äºŒè¿›åˆ¶æ–‡ä»¶æ“ä½œ

<UniversalEditor title="äºŒè¿›åˆ¶æ–‡ä»¶æ“ä½œ" compare={true}>
```javascript !! js
// JavaScript - äºŒè¿›åˆ¶æ–‡ä»¶å¤„ç†
const fs = require('fs');

// è¯»å–äºŒè¿›åˆ¶æ–‡ä»¶
fs.readFile('image.jpg', (err, data) => {
    if (err) throw err;
    console.log('äºŒè¿›åˆ¶æ•°æ®é•¿åº¦:', data.length);
    
    // å¤„ç†äºŒè¿›åˆ¶æ•°æ®
    const buffer = Buffer.from(data);
    console.log('å‰ 10 å­—èŠ‚:', buffer.slice(0, 10));
});

// å†™å…¥äºŒè¿›åˆ¶æ•°æ®
const binaryData = Buffer.from([0x48, 0x65, 0x6C, 0x6C, 0x6F]); // "Hello"
fs.writeFile('binary.dat', binaryData, (err) => {
    if (err) throw err;
    console.log('äºŒè¿›åˆ¶æ–‡ä»¶å·²å†™å…¥');
});
```

```c !! c
#include <stdio.h>
#include <stdlib.h>

// äºŒè¿›åˆ¶æ•°æ®ç»“æ„
typedef struct {
    int id;
    char name[50];
    float score;
} Student;

int main() {
    FILE* file;
    Student student;
    
    // å†™å…¥äºŒè¿›åˆ¶æ•°æ®
    file = fopen("students.dat", "wb");
    if (file == NULL) {
        printf("ä»¥å†™å…¥æ¨¡å¼æ‰“å¼€æ–‡ä»¶é”™è¯¯\n");
        return 1;
    }
    
    // å†™å…¥å­¦ç”Ÿè®°å½•
    Student students[] = {
        {1, "Alice", 95.5},
        {2, "Bob", 87.2},
        {3, "Charlie", 92.8}
    };
    
    fwrite(students, sizeof(Student), 3, file);
    fclose(file);
    
    // è¯»å–äºŒè¿›åˆ¶æ•°æ®
    file = fopen("students.dat", "rb");
    if (file == NULL) {
        printf("ä»¥è¯»å–æ¨¡å¼æ‰“å¼€æ–‡ä»¶é”™è¯¯\n");
        return 1;
    }
    
    // è¯»å–å­¦ç”Ÿè®°å½•
    while (fread(&student, sizeof(Student), 1, file) == 1) {
        printf("ID: %d, å§“å: %s, åˆ†æ•°: %.1f\n", 
               student.id, student.name, student.score);
    }
    
    fclose(file);
    return 0;
}
```
</UniversalEditor>

## 6. å¸¸è§é™·é˜±
- **æœªæ£€æŸ¥æ–‡ä»¶æ‰“å¼€æˆåŠŸ**ï¼šå§‹ç»ˆæ£€æŸ¥ `fopen()` æ˜¯å¦è¿”å› NULL
- **å¿˜è®°å…³é—­æ–‡ä»¶**ï¼šå§‹ç»ˆè°ƒç”¨ `fclose()` ä»¥é˜²æ­¢èµ„æºæ³„æ¼
- **ç¼“å†²åŒºæº¢å‡º**ï¼šç¡®ä¿ç¼“å†²åŒºå¤§å°å¯¹æ–‡ä»¶æ“ä½œè¶³å¤Ÿ
- **æ–‡ä»¶å®šä½é”™è¯¯**ï¼šè°¨æ…ä½¿ç”¨ `fseek()` å’Œ `ftell()`
- **äºŒè¿›åˆ¶ä¸æ–‡æœ¬æ¨¡å¼**ï¼šä¸ºæ–‡ä»¶ç±»å‹ä½¿ç”¨é€‚å½“çš„æ¨¡å¼

## 7. ç»ƒä¹ é¢˜
1. ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œå°†ä¸€ä¸ªæ–‡ä»¶å¤åˆ¶åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ï¼Œé€‚å½“å¤„ç†é”™è¯¯ã€‚
2. åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œé€è¡Œè¯»å–æ–‡ä»¶å¹¶è®¡ç®—å•è¯æ•°é‡ã€‚
3. ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œå°†å¸¦æ—¶é—´æˆ³çš„æ•°æ®è¿½åŠ åˆ°æ—¥å¿—æ–‡ä»¶ã€‚

## 8. æ€§èƒ½åˆ†æ
- C æ–‡ä»¶æ“ä½œé€šå¸¸æ¯” JavaScript æ›´å¿«ï¼Œå› ä¸ºç›´æ¥ä½¿ç”¨ç³»ç»Ÿè°ƒç”¨
- ç¼“å†² I/Oï¼ˆ`fprintf`ã€`fscanf`ï¼‰æ¯”é€å­—ç¬¦ I/O æ›´é«˜æ•ˆ
- äºŒè¿›åˆ¶æ–‡ä»¶æ“ä½œæ¯”æ–‡æœ¬æ“ä½œæ›´å¿«
- é€‚å½“çš„é”™è¯¯å¤„ç†å¯¹å¥å£®çš„æ–‡ä»¶æ“ä½œè‡³å…³é‡è¦

---

> **å°ç»“**ï¼šC æ–‡ä»¶æ“ä½œæä¾›åº•å±‚æ§åˆ¶å’Œé«˜æ€§èƒ½ï¼Œä½†éœ€è¦ä»”ç»†çš„é”™è¯¯å¤„ç†å’Œèµ„æºç®¡ç†ã€‚ç†è§£æ–‡ä»¶æ¨¡å¼ã€å®šä½å’ŒäºŒè¿›åˆ¶æ“ä½œå¯¹ç³»ç»Ÿç¼–ç¨‹è‡³å…³é‡è¦ã€‚ 